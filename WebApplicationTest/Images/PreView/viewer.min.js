(function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define(t):(n=n||self,n.Viewer=t())})(this,function(){"use strict";function ft(n){return ft=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ft(n)}function sr(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function fi(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function hr(n,t,i){return t&&fi(n.prototype,t),i&&fi(n,i),n}function vt(n){return typeof n=="string"}function f(n){return typeof n=="number"&&!gr(n)}function g(n){return typeof n=="undefined"}function nt(n){return ft(n)==="object"&&n!==null}function yt(n){if(!nt(n))return!1;try{var t=n.constructor,i=t.prototype;return t&&i&&nu.call(i,"isPrototypeOf")}catch(r){return!1}}function o(n){return typeof n=="function"}function u(n,t){if(n&&o(t))if(Array.isArray(n)||f(n.length)){for(var r=n.length,i=0;i<r;i+=1)if(t.call(n,n[i],i,n)===!1)break}else nt(n)&&Object.keys(n).forEach(function(i){t.call(n,n[i],i,n)});return n}function l(n,t){var i=n.style;u(t,function(n,t){tu.test(t)&&f(n)&&(n+="px");i[t]=n})}function ur(n,t){return n.classList?n.classList.contains(t):n.className.indexOf(t)>-1}function n(t,i){if(i){if(f(t.length)){u(t,function(t){n(t,i)});return}if(t.classList){t.classList.add(i);return}var r=t.className.trim();r?r.indexOf(i)<0&&(t.className="".concat(r," ").concat(i)):t.className=i}}function r(n,t){if(t){if(f(n.length)){u(n,function(n){r(n,t)});return}if(n.classList){n.classList.remove(t);return}n.className.indexOf(t)>=0&&(n.className=n.className.replace(t,""))}}function rt(t,i,e){if(i){if(f(t.length)){u(t,function(n){rt(n,i,e)});return}e?n(t,i):r(t,i)}}function ii(n){return n.replace(iu,"$1-$2").toLowerCase()}function ut(n,t){return nt(n[t])?n[t]:n.dataset?n.dataset[t]:n.getAttribute("data-".concat(ii(t)))}function ri(n,t,i){nt(i)?n[t]=i:n.dataset?n.dataset[t]=i:n.setAttribute("data-".concat(ii(t)),i)}function s(n,t,i){var u=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{},r=i;t.trim().split(ti).forEach(function(t){if(!fr){var f=n.listeners;f&&f[t]&&f[t][i]&&(r=f[t][i],delete f[t][i],Object.keys(f[t]).length===0&&delete f[t],Object.keys(f).length===0&&delete n.listeners)}n.removeEventListener(t,r,u)})}function i(n,t,i){var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{},u=i;t.trim().split(ti).forEach(function(t){if(r.once&&!fr){var e=n.listeners,f=e===void 0?{}:e;u=function(){delete f[t][i];n.removeEventListener(t,u,r);for(var o=arguments.length,s=new Array(o),e=0;e<o;e++)s[e]=arguments[e];i.apply(n,s)};f[t]||(f[t]={});f[t][i]&&n.removeEventListener(t,f[t][i],r);f[t][i]=u;n.listeners=f}n.addEventListener(t,u,r)})}function c(n,t,i){var r;return o(Event)&&o(CustomEvent)?r=new CustomEvent(t,{detail:i,bubbles:!0,cancelable:!0}):(r=document.createEvent("CustomEvent"),r.initCustomEvent(t,!0,!0,i)),n.dispatchEvent(r)}function ru(n){var t=n.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}function pt(n){var r=n.rotate,u=n.scaleX,e=n.scaleY,o=n.translateX,s=n.translateY,t=[],i;return f(o)&&o!==0&&t.push("translateX(".concat(o,"px)")),f(s)&&s!==0&&t.push("translateY(".concat(s,"px)")),f(r)&&r!==0&&t.push("rotate(".concat(r,"deg)")),f(u)&&u!==1&&t.push("scaleX(".concat(u,")")),f(e)&&e!==1&&t.push("scaleY(".concat(e,")")),i=t.length?t.join(" "):"none",{WebkitTransform:i,msTransform:i,transform:i}}function uu(n){return vt(n)?n.replace(/^.*\//,"").replace(/[?&#].*$/,""):""}function er(n,t){var i=document.createElement("img"),r;return n.naturalWidth&&!ui?(t(n.naturalWidth,n.naturalHeight),i):(r=document.body||document.documentElement,i.onload=function(){t(i.width,i.height);ui||r.removeChild(i)},i.src=n.src,ui||(i.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",r.appendChild(i)),i)}function wt(n){switch(n){case 2:return pr;case 3:return yr;case 4:return vr;default:return""}}function fu(n){var i=h({},n),t=[];return u(n,function(n,r){delete i[r];u(i,function(i){var r=Math.abs(n.startX-i.startX),u=Math.abs(n.startY-i.startY),f=Math.abs(n.endX-i.endX),e=Math.abs(n.endY-i.endY),o=Math.sqrt(r*r+u*u),s=Math.sqrt(f*f+e*e),h=(s-o)/o;t.push(h)})}),t.sort(function(n,t){return Math.abs(n)<Math.abs(t)}),t[0]}function bt(n,t){var i=n.pageX,r=n.pageY,u={endX:i,endY:r};return t?u:h({timeStamp:Date.now(),startX:i,startY:r},u)}function eu(n){var t=0,i=0,r=0;return u(n,function(n){var u=n.startX,f=n.startY;t+=u;i+=f;r+=1}),t/=r,i/=r,{pageX:t,pageY:i}}var ei={backdrop:!0,button:!0,navbar:!0,title:!0,toolbar:!0,className:"",container:"body",filter:null,fullscreen:!0,initialViewIndex:0,inline:!1,interval:5e3,keyboard:!0,loading:!0,loop:!0,minWidth:200,minHeight:100,movable:!0,zoomable:!0,rotatable:!0,scalable:!0,toggleOnDblclick:!0,tooltip:!0,transition:!0,zIndex:2015,zIndexInline:0,zoomRatio:.1,minZoomRatio:.01,maxZoomRatio:100,url:"src",ready:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null,zoom:null,zoomed:null},cr='<div class="viewer-container" touch-action="none"><div class="viewer-canvas"><\/div><div class="viewer-footer"><div class="viewer-title"><\/div><div class="viewer-toolbar"><\/div><div class="viewer-navbar"><ul class="viewer-list"><\/ul><\/div><\/div><div class="viewer-tooltip"><\/div><div role="button" class="viewer-button" data-viewer-action="mix"><\/div><div class="viewer-player"><\/div><\/div>',et=typeof window!="undefined",p=et?window:{},b=et?"ontouchstart"in p.document.documentElement:!1,kt=et?"PointerEvent"in p:!1,t="viewer",ot="move",oi="switch",tt="zoom",st="".concat(t,"-active"),lr="".concat(t,"-close"),ht="".concat(t,"-fade"),dt="".concat(t,"-fixed"),ar="".concat(t,"-fullscreen"),si="".concat(t,"-fullscreen-exit"),w="".concat(t,"-hide"),vr="".concat(t,"-hide-md-down"),yr="".concat(t,"-hide-sm-down"),pr="".concat(t,"-hide-xs-down"),a="".concat(t,"-in"),ct="".concat(t,"-invisible"),lt="".concat(t,"-loading"),wr="".concat(t,"-move"),hi="".concat(t,"-open"),k="".concat(t,"-show"),e="".concat(t,"-transition"),d="click",gt="dblclick",ci="dragstart",li="hidden",ai="hide",vi="keydown",y="load",br=b?"touchstart":"mousedown",kr=b?"touchmove":"mousemove",dr=b?"touchend touchcancel":"mouseup",yi=kt?"pointerdown":br,pi=kt?"pointermove":kr,wi=kt?"pointerup pointercancel":dr,bi="ready",ki="resize",di="show",gi="shown",v="transitionend",nr="view",it="viewed",tr="wheel",ir="zoom",rr="zoomed",ni="".concat(t,"Action"),ti=/\s\s*/,at=["zoom-in","zoom-out","one-to-one","reset","prev","play","next","rotate-left","rotate-right","flip-horizontal","flip-vertical"],gr=Number.isNaN||p.isNaN,nu=Object.prototype.hasOwnProperty,h=Object.assign||function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];return nt(n)&&r.length>0&&r.forEach(function(t){nt(t)&&Object.keys(t).forEach(function(i){n[i]=t[i]})}),n},tu=/^(?:width|height|left|top|marginLeft|marginTop)$/,iu=/([a-z\d])([A-Z])/g,fr=function(){var n=!1;if(et){var t=!1,i=function(){},r=Object.defineProperty({},"once",{get:function(){return n=!0,t},set:function(n){t=n}});p.addEventListener("test",i,r);p.removeEventListener("test",i,r)}return n}(),ui=p.navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(p.navigator.userAgent),ou={render:function(){this.initContainer();this.initViewer();this.initList();this.renderViewer()},initContainer:function(){this.containerData={width:window.innerWidth,height:window.innerHeight}},initViewer:function(){var t=this.options,i=this.parent,n;t.inline&&(n={width:Math.max(i.offsetWidth,t.minWidth),height:Math.max(i.offsetHeight,t.minHeight)},this.parentData=n);(this.fulled||!n)&&(n=this.containerData);this.viewerData=h({},n)},renderViewer:function(){this.options.inline&&!this.fulled&&l(this.viewer,this.viewerData)},initList:function(){var s=this,c=this.element,t=this.options,f=this.list,h=[];u(this.images,function(n,i){var u=n.src,f=n.alt||uu(u),r=t.url;vt(r)?r=n.getAttribute(r):o(r)&&(r=r.call(s,n));(u||r)&&h.push("<li><img"+' src="'.concat(u||r,'"')+' role="button" data-viewer-action="view"'+' data-index="'.concat(i,'"')+' data-original-url="'.concat(r||u,'"')+' alt="'.concat(f,'"')+"><\/li>")});f.innerHTML=h.join("");this.items=f.getElementsByTagName("li");u(this.items,function(u){var f=u.firstElementChild;ri(f,"filled",!0);t.loading&&n(u,lt);i(f,y,function(n){t.loading&&r(u,lt);s.loadImage(n)},{once:!0})});t.transition&&i(c,it,function(){n(f,e)},{once:!0})},renderList:function(n){var t=n||this.index,i=this.items[t].offsetWidth||30,r=i+1;l(this.list,h({width:r*this.length},pt({translateX:(this.viewerData.width-i)/2-r*t})))},resetList:function(){var n=this.list;n.innerHTML="";r(n,e);l(n,pt({translateX:0}))},initImage:function(n){var r=this,f=this.options,c=this.image,e=this.viewerData,o=this.footer.offsetHeight,t=e.width,i=Math.max(e.height-o,o),u=this.imageData||{},s;this.imageInitializing={abort:function(){s.onload=null}};s=er(c,function(e,o){var v=e/o,s=t,l=i,c,a;r.imageInitializing=!1;i*v>t?l=t/v:s=i*v;s=Math.min(s*.9,e);l=Math.min(l*.9,o);c={naturalWidth:e,naturalHeight:o,aspectRatio:v,ratio:s/e,width:s,height:l,left:(t-s)/2,top:(i-l)/2};a=h({},c);f.rotatable&&(c.rotate=u.rotate||0,a.rotate=0);f.scalable&&(c.scaleX=u.scaleX||1,c.scaleY=u.scaleY||1,a.scaleX=1,a.scaleY=1);r.imageData=c;r.initialImageData=a;n&&n()})},renderImage:function(n){var f=this,r=this.image,t=this.imageData,u;l(r,h({width:t.width,height:t.height,marginLeft:t.left,marginTop:t.top},pt(t)));n&&((this.viewing||this.zooming)&&this.options.transition?(u=function(){f.imageRendering=!1;n()},this.imageRendering={abort:function(){s(r,v,u)}},i(r,v,u,{once:!0})):n())},resetImage:function(){if(this.viewing||this.viewed){var n=this.image;this.viewing&&this.viewing.abort();n.parentNode.removeChild(n);this.image=null}}},su={bind:function(){var u=this.options,n=this.viewer,r=this.canvas,t=this.element.ownerDocument;i(n,d,this.onClick=this.click.bind(this));i(n,tr,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0});i(n,ci,this.onDragStart=this.dragstart.bind(this));i(r,yi,this.onPointerDown=this.pointerdown.bind(this));i(t,pi,this.onPointerMove=this.pointermove.bind(this));i(t,wi,this.onPointerUp=this.pointerup.bind(this));i(t,vi,this.onKeyDown=this.keydown.bind(this));i(window,ki,this.onResize=this.resize.bind(this));u.toggleOnDblclick&&i(r,gt,this.onDblclick=this.dblclick.bind(this))},unbind:function(){var r=this.options,n=this.viewer,i=this.canvas,t=this.element.ownerDocument;s(n,d,this.onClick);s(n,tr,this.onWheel,{passive:!1,capture:!0});s(n,ci,this.onDragStart);s(i,yi,this.onPointerDown);s(t,pi,this.onPointerMove);s(t,wi,this.onPointerUp);s(t,vi,this.onKeyDown);s(window,ki,this.onResize);r.toggleOnDblclick&&s(i,gt,this.onDblclick)}},hu={click:function(n){var i=n.target,t=this.options,r=this.imageData,u=ut(i,ni);b&&n.isTrusted&&i===this.canvas&&clearTimeout(this.clickCanvasTimeout);switch(u){case"mix":this.played?this.stop():t.inline?this.fulled?this.exit():this.full():this.hide();break;case"hide":this.hide();break;case"view":this.view(ut(i,"index"));break;case"zoom-in":this.zoom(.1,!0);break;case"zoom-out":this.zoom(-.1,!0);break;case"one-to-one":this.toggle();break;case"reset":this.reset();break;case"prev":this.prev(t.loop);break;case"play":this.play(t.fullscreen);break;case"next":this.next(t.loop);break;case"rotate-left":this.rotate(-90);break;case"rotate-right":this.rotate(90);break;case"flip-horizontal":this.scaleX(-r.scaleX||-1);break;case"flip-vertical":this.scaleY(-r.scaleY||-1);break;default:this.played&&this.stop()}},dblclick:function(n){n.preventDefault();this.viewed&&n.target===this.image&&(b&&n.isTrusted&&clearTimeout(this.doubleClickImageTimeout),this.toggle())},load:function(){var u=this;this.timeout&&(clearTimeout(this.timeout),this.timeout=!1);var f=this.element,n=this.options,t=this.image,s=this.index,h=this.viewerData;r(t,ct);n.loading&&r(this.canvas,lt);t.style.cssText="height:0;"+"margin-left:".concat(h.width/2,"px;")+"margin-top:".concat(h.height/2,"px;")+"max-width:none!important;position:absolute;width:0;";this.initImage(function(){rt(t,wr,n.movable);rt(t,e,n.transition);u.renderImage(function(){u.viewed=!0;u.viewing=!1;o(n.viewed)&&i(f,it,n.viewed,{once:!0});c(f,it,{originalImage:u.images[s],index:s,image:t})})})},loadImage:function(n){var r=n.target,u=r.parentNode,t=u.offsetWidth||30,i=u.offsetHeight||50,f=!!ut(r,"filled");er(r,function(n,u){var e=n/u,o=t,s=i;i*e>t?f?o=i*e:s=t/e:f?s=t/e:o=i*e;l(r,h({width:o,height:s},pt({translateX:(t-o)/2,translateY:(i-s)/2})))})},keydown:function(n){var t=this.options;if(this.fulled&&t.keyboard)switch(n.keyCode||n.which||n.charCode){case 27:this.played?this.stop():t.inline?this.fulled&&this.exit():this.hide();break;case 32:this.played&&this.stop();break;case 37:this.prev(t.loop);break;case 38:n.preventDefault();this.zoom(t.zoomRatio,!0);break;case 39:this.next(t.loop);break;case 40:n.preventDefault();this.zoom(-t.zoomRatio,!0);break;case 48:case 49:n.ctrlKey&&(n.preventDefault(),this.toggle())}},dragstart:function(n){n.target.tagName.toLowerCase()==="img"&&n.preventDefault()},pointerdown:function(n){var o=this.options,i=this.pointers,s=n.buttons,h=n.button,t;!this.viewed||this.showing||this.viewing||this.hiding||f(s)&&s!==1||f(h)&&h!==0||n.ctrlKey||(n.preventDefault(),n.changedTouches?u(n.changedTouches,function(n){i[n.identifier]=bt(n)}):i[n.pointerId||0]=bt(n),t=o.movable?ot:!1,Object.keys(i).length>1?t=tt:(n.pointerType==="touch"||n.type==="touchstart")&&this.isSwitchable()&&(t=oi),o.transition&&(t===ot||t===tt)&&r(this.image,e),this.action=t)},pointermove:function(n){var t=this.pointers,i=this.action;this.viewed&&i&&(n.preventDefault(),n.changedTouches?u(n.changedTouches,function(n){h(t[n.identifier]||{},bt(n,!0))}):h(t[n.pointerId||0]||{},bt(n,!0)),this.change(n))},pointerup:function(t){var s=this,i=this.options,r=this.action,f=this.pointers,o;(t.changedTouches?u(t.changedTouches,function(n){o=f[n.identifier];delete f[n.identifier]}):(o=f[t.pointerId||0],delete f[t.pointerId||0]),r)&&(t.preventDefault(),i.transition&&(r===ot||r===tt)&&n(this.image,e),this.action=!1,b&&r!==tt&&o&&Date.now()-o.timeStamp<500&&(clearTimeout(this.clickCanvasTimeout),clearTimeout(this.doubleClickImageTimeout),i.toggleOnDblclick&&this.viewed&&t.target===this.image?this.imageClicked?(this.imageClicked=!1,this.doubleClickImageTimeout=setTimeout(function(){c(s.image,gt)},50)):(this.imageClicked=!0,this.doubleClickImageTimeout=setTimeout(function(){s.imageClicked=!1},500)):(this.imageClicked=!1,i.backdrop&&i.backdrop!=="static"&&t.target===this.canvas&&(this.clickCanvasTimeout=setTimeout(function(){c(s.canvas,d)},50)))))},resize:function(){var n=this;if(this.isShown&&!this.hiding&&(this.initContainer(),this.initViewer(),this.renderViewer(),this.renderList(),this.viewed&&this.initImage(function(){n.renderImage()}),this.played)){if(this.options.fullscreen&&this.fulled&&!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)){this.stop();return}u(this.player.getElementsByTagName("img"),function(t){i(t,y,n.loadImage.bind(n),{once:!0});c(t,y)})}},wheel:function(n){var r=this,i,t;this.viewed&&((n.preventDefault(),this.wheeling)||(this.wheeling=!0,setTimeout(function(){r.wheeling=!1},50),i=Number(this.options.zoomRatio)||.1,t=1,n.deltaY?t=n.deltaY>0?1:-1:n.wheelDelta?t=-n.wheelDelta/120:n.detail&&(t=n.detail>0?1:-1),this.zoom(-t*i,!0,n)))}},cu={show:function(){var h=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,l=this.element,u=this.options,t,f;return u.inline||this.showing||this.isShown||this.showing?this:this.ready?(o(u.show)&&i(l,di,u.show,{once:!0}),c(l,di)===!1||!this.ready)?this:(this.hiding&&this.transitioning.abort(),this.showing=!0,this.open(),t=this.viewer,r(t,w),u.transition&&!h?(f=this.shown.bind(this),this.transitioning={abort:function(){s(t,v,f);r(t,a)}},n(t,e),t.offsetWidth,i(t,v,f,{once:!0}),n(t,a)):(n(t,a),this.shown()),this):(this.build(),this.ready&&this.show(h),this)},hide:function(){var l=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,h=this.element,t=this.options,n,f,u;return t.inline||this.hiding||!(this.isShown||this.showing)?this:(o(t.hide)&&i(h,ai,t.hide,{once:!0}),c(h,ai)===!1)?this:(this.showing&&this.transitioning.abort(),this.hiding=!0,this.played?this.stop():this.viewing&&this.viewing.abort(),n=this.viewer,t.transition&&!l?(f=this.hidden.bind(this),u=function(){i(n,v,f,{once:!0});r(n,a)},this.transitioning={abort:function(){this.viewed?s(this.image,v,u):s(n,v,f)}},this.viewed&&ur(this.image,e)?(i(this.image,v,u,{once:!0}),this.zoomTo(0,!1,!1,!0)):u()):(r(n,a),this.hidden()),this)},view:function(){var h=this,u=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.options.initialViewIndex,a,k;if(u=Number(u)||0,!this.isShown)return this.index=u,this.show();if(this.hiding||this.played||u<0||u>=this.length||this.viewed&&u===this.index)return this;this.viewing&&this.viewing.abort();var e=this.element,f=this.options,v=this.title,l=this.canvas,p=this.items[u],w=p.querySelector("img"),d=ut(w,"originalUrl"),b=w.getAttribute("alt"),t=document.createElement("img");return(t.src=d,t.alt=b,o(f.view)&&i(e,nr,f.view,{once:!0}),c(e,nr,{originalImage:this.images[u],index:u,image:t})===!1||!this.isShown||this.hiding||this.played)?this:(this.image=t,r(this.items[this.index],st),n(p,st),this.viewed=!1,this.index=u,this.imageData={},n(t,ct),f.loading&&n(l,lt),l.innerHTML="",l.appendChild(t),this.renderList(),v.innerHTML="",a=function(){var n=h.imageData,i=Array.isArray(f.title)?f.title[1]:f.title;v.innerHTML=o(i)?i.call(h,t,n):"".concat(b," (").concat(n.naturalWidth," × ").concat(n.naturalHeight,")")},i(e,it,a,{once:!0}),this.viewing={abort:function(){s(e,it,a);t.complete?this.imageRendering?this.imageRendering.abort():this.imageInitializing&&this.imageInitializing.abort():(t.src="",s(t,y,k),this.timeout&&clearTimeout(this.timeout))}},t.complete?this.load():(i(t,y,k=this.load.bind(this),{once:!0}),this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){r(t,ct);h.timeout=!1},1e3)),this)},prev:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,n=this.index-1;return n<0&&(n=t?this.length-1:0),this.view(n),this},next:function(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,t=this.length-1,n=this.index+1;return n>t&&(n=i?0:t),this.view(n),this},move:function(n,t){var i=this.imageData;return this.moveTo(g(n)?n:i.left+Number(n),g(t)?t:i.top+Number(t)),this},moveTo:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:n,r=this.imageData,i;return n=Number(n),t=Number(t),this.viewed&&!this.played&&this.options.movable&&(i=!1,f(n)&&(r.left=n,i=!0),f(t)&&(r.top=t,i=!0),i&&this.renderImage()),this},zoom:function(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,t=this.imageData;return n=Number(n),n=n<0?1/(1-n):1+n,this.zoomTo(t.width*n/t.naturalWidth,i,r),this},zoomTo:function(n){var it=this,rt=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1,u=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null,v=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1,e=this.element,r=this.options,s=this.pointers,t=this.imageData,h=t.width,y=t.height,ut=t.left,ft=t.top,p=t.naturalWidth,et=t.naturalHeight,w,b,l,a;if(n=Math.max(0,n),f(n)&&this.viewed&&!this.played&&(v||r.zoomable)){v||(w=Math.max(.01,r.minZoomRatio),b=Math.min(100,r.maxZoomRatio),n=Math.min(Math.max(n,w),b));u&&n>.95&&n<1.05&&(n=1);var k=p*n,d=et*n,g=k-h,nt=d-y,tt=h/p;if(o(r.zoom)&&i(e,ir,r.zoom,{once:!0}),c(e,ir,{ratio:n,oldRatio:tt,originalEvent:u})===!1)return this;this.zooming=!0;u?(l=ru(this.viewer),a=s&&Object.keys(s).length?eu(s):{pageX:u.pageX,pageY:u.pageY},t.left-=g*((a.pageX-l.left-ut)/h),t.top-=nt*((a.pageY-l.top-ft)/y)):(t.left-=g/2,t.top-=nt/2);t.width=k;t.height=d;t.ratio=n;this.renderImage(function(){it.zooming=!1;o(r.zoomed)&&i(e,rr,r.zoomed,{once:!0});c(e,rr,{ratio:n,oldRatio:tt,originalEvent:u})});rt&&this.tooltip()}return this},rotate:function(n){return this.rotateTo((this.imageData.rotate||0)+Number(n)),this},rotateTo:function(n){var t=this.imageData;return n=Number(n),f(n)&&this.viewed&&!this.played&&this.options.rotatable&&(t.rotate=n,this.renderImage()),this},scaleX:function(n){return this.scale(n,this.imageData.scaleY),this},scaleY:function(n){return this.scale(this.imageData.scaleX,n),this},scale:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:n,r=this.imageData,i;return n=Number(n),t=Number(t),this.viewed&&!this.played&&this.options.scalable&&(i=!1,f(n)&&(r.scaleX=n,i=!0),f(t)&&(r.scaleY=t,i=!0),i&&this.renderImage()),this},play:function(){var p=this,w=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,c;if(!this.isShown||this.played)return this;var o=this.options,l=this.player,v=this.loadImage.bind(this),s=[],h=0,t=0;return this.played=!0,this.onLoadWhenPlay=v,w&&this.requestFullscreen(),n(l,k),u(this.items,function(r,u){var c=r.querySelector("img"),f=document.createElement("img");f.src=ut(c,"originalUrl");f.alt=c.getAttribute("alt");h+=1;n(f,ht);rt(f,e,o.transition);ur(r,st)&&(n(f,a),t=u);s.push(f);i(f,y,v,{once:!0});l.appendChild(f)}),f(o.interval)&&o.interval>0&&(c=function c(){p.playing=setTimeout(function(){r(s[t],a);t+=1;t=t<h?t:0;n(s[t],a);c()},o.interval)},h>1&&c()),this},stop:function(){var t=this,n;return this.played?(n=this.player,this.played=!1,clearTimeout(this.playing),u(n.getElementsByTagName("img"),function(n){s(n,y,t.onLoadWhenPlay)}),r(n,k),n.innerHTML="",this.exitFullscreen(),this):this},full:function(){var o=this,t=this.options,i=this.viewer,u=this.image,f=this.list;return!this.isShown||this.played||this.fulled||!t.inline?this:(this.fulled=!0,this.open(),n(this.button,si),t.transition&&(r(f,e),this.viewed&&r(u,e)),n(i,dt),i.setAttribute("style",""),l(i,{zIndex:t.zIndex}),this.initContainer(),this.viewerData=h({},this.containerData),this.renderList(),this.viewed&&this.initImage(function(){o.renderImage(function(){t.transition&&setTimeout(function(){n(u,e);n(f,e)},0)})}),this)},exit:function(){var o=this,t=this.options,i=this.viewer,u=this.image,f=this.list;return!this.isShown||this.played||!this.fulled||!t.inline?this:(this.fulled=!1,this.close(),r(this.button,si),t.transition&&(r(f,e),this.viewed&&r(u,e)),r(i,dt),l(i,{zIndex:t.zIndexInline}),this.viewerData=h({},this.parentData),this.renderViewer(),this.renderList(),this.viewed&&this.initImage(function(){o.renderImage(function(){t.transition&&setTimeout(function(){n(u,e);n(f,e)},0)})}),this)},tooltip:function(){var u=this,f=this.options,t=this.tooltipBox,o=this.imageData;return!this.viewed||this.played||!f.tooltip?this:(t.textContent="".concat(Math.round(o.ratio*100),"%"),this.tooltipping?clearTimeout(this.tooltipping):f.transition?(this.fading&&c(t,v),n(t,k),n(t,ht),n(t,e),t.offsetWidth,n(t,a)):n(t,k),this.tooltipping=setTimeout(function(){f.transition?(i(t,v,function(){r(t,k);r(t,ht);r(t,e);u.fading=!1},{once:!0}),r(t,a),u.fading=!0):r(t,k);u.tooltipping=!1},1e3),this)},toggle:function(){return this.imageData.ratio===1?this.zoomTo(this.initialImageData.ratio,!0):this.zoomTo(1,!0),this},reset:function(){return this.viewed&&!this.played&&(this.imageData=h({},this.initialImageData),this.renderImage()),this},update:function(){var r=this.element,e=this.options,o=this.isImg,t,i,f;return o&&!r.parentNode?this.destroy():(t=[],u(o?[r]:r.querySelectorAll("img"),function(n){e.filter?e.filter(n)&&t.push(n):t.push(n)}),!t.length)?this:(this.images=t,this.length=t.length,this.ready?(i=[],u(this.items,function(n,r){var f=n.querySelector("img"),u=t[r];u?u.src!==f.src&&i.push(r):i.push(r)}),l(this.list,{width:"auto"}),this.initList(),this.isShown&&(this.length?this.viewed&&(f=i.indexOf(this.index),f>=0?(this.viewed=!1,this.view(Math.max(this.index-(f+1),0))):n(this.items[this.index],st)):(this.image=null,this.viewed=!1,this.index=0,this.imageData={},this.canvas.innerHTML="",this.title.innerHTML=""))):this.build(),this)},destroy:function(){var n=this.element,i=this.options;return n[t]?(this.destroyed=!0,this.ready?(this.played&&this.stop(),i.inline?(this.fulled&&this.exit(),this.unbind()):this.isShown?(this.viewing&&(this.imageRendering?this.imageRendering.abort():this.imageInitializing&&this.imageInitializing.abort()),this.hiding&&this.transitioning.abort(),this.hidden()):this.showing&&(this.transitioning.abort(),this.hidden()),this.ready=!1,this.viewer.parentNode.removeChild(this.viewer)):i.inline&&(this.delaying?this.delaying.abort():this.initializing&&this.initializing.abort()),i.inline||s(n,d,this.onStart),n[t]=undefined,this):this}},lu={open:function(){var t=this.body;n(t,hi);t.style.paddingRight="".concat(this.scrollbarWidth+(parseFloat(this.initialBodyPaddingRight)||0),"px")},close:function(){var n=this.body;r(n,hi);n.style.paddingRight=this.initialBodyPaddingRight},shown:function(){var n=this.element,t=this.options;(this.fulled=!0,this.isShown=!0,this.render(),this.bind(),this.showing=!1,o(t.shown)&&i(n,gi,t.shown,{once:!0}),c(n,gi)!==!1)&&this.ready&&this.isShown&&!this.hiding&&this.view(this.index)},hidden:function(){var t=this.element,r=this.options;this.fulled=!1;this.viewed=!1;this.isShown=!1;this.close();this.unbind();n(this.viewer,w);this.resetList();this.resetImage();this.hiding=!1;this.destroyed||(o(r.hidden)&&i(t,li,r.hidden,{once:!0}),c(t,li))},requestFullscreen:function(){var t=this.element.ownerDocument,n;!this.fulled||t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement||(n=t.documentElement,n.requestFullscreen?n.requestFullscreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):n.mozRequestFullScreen?n.mozRequestFullScreen():n.msRequestFullscreen&&n.msRequestFullscreen())},exitFullscreen:function(){var n=this.element.ownerDocument;this.fulled&&(n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement)&&(n.exitFullscreen?n.exitFullscreen():n.webkitExitFullscreen?n.webkitExitFullscreen():n.mozCancelFullScreen?n.mozCancelFullScreen():n.msExitFullscreen&&n.msExitFullscreen())},change:function(n){var e=this.options,t=this.pointers,i=t[Object.keys(t)[0]],r=i.endX-i.startX,o=i.endY-i.startY,f;switch(this.action){case ot:this.move(r,o);break;case tt:this.zoom(fu(t),!1,n);break;case oi:this.action="switched";f=Math.abs(r);f>1&&f>Math.abs(o)&&(this.pointers={},r>1?this.prev(e.loop):r<-1&&this.next(e.loop))}u(t,function(n){n.startX=n.endX;n.startY=n.endY})},isSwitchable:function(){var n=this.imageData,t=this.viewerData;return this.length>1&&n.left>=0&&n.top>=0&&n.width<=t.width&&n.height<=t.height}},au=p.Viewer,or=function(){function r(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(sr(this,r),!n||n.nodeType!==1)throw new Error("The first argument is required and must be an element.");this.element=n;this.options=h({},ei,yt(t)&&t);this.action=!1;this.fading=!1;this.fulled=!1;this.hiding=!1;this.imageClicked=!1;this.imageData={};this.index=this.options.initialViewIndex;this.isImg=!1;this.isShown=!1;this.length=0;this.played=!1;this.playing=!1;this.pointers={};this.ready=!1;this.showing=!1;this.timeout=!1;this.tooltipping=!1;this.viewed=!1;this.viewing=!1;this.wheeling=!1;this.zooming=!1;this.init()}return hr(r,[{key:"init",value:function(){var n=this,r=this.element,e=this.options,l,f,h,a,v,c;r[t]||(r[t]=this,l=r.tagName.toLowerCase()==="img",f=[],u(l?[r]:r.querySelectorAll("img"),function(t){o(e.filter)?e.filter.call(n,t)&&f.push(t):f.push(t)}),this.isImg=l,this.length=f.length,this.images=f,h=r.ownerDocument,a=h.body||h.documentElement,this.body=a,this.scrollbarWidth=window.innerWidth-h.documentElement.clientWidth,this.initialBodyPaddingRight=window.getComputedStyle(a).paddingRight,g(document.createElement(t).style.transition)&&(e.transition=!1),e.inline?(v=0,c=function(){if(v+=1,v===n.length){var t;n.initializing=!1;n.delaying={abort:function(){clearTimeout(t)}};t=setTimeout(function(){n.delaying=!1;n.build()},0)}},this.initializing={abort:function(){u(f,function(n){n.complete||s(n,y,c)})}},u(f,function(n){n.complete?c():i(n,y,c,{once:!0})})):i(r,d,this.onStart=function(t){var i=t.target;i.tagName.toLowerCase()==="img"&&(!o(e.filter)||e.filter.call(n,i))&&n.view(n.images.indexOf(i))}))}},{key:"build",value:function(){var b,s;if(!this.ready){var a=this.element,r=this.options,v=a.parentNode,k=document.createElement("div");k.innerHTML=cr;var e=k.querySelector(".".concat(t,"-container")),nt=e.querySelector(".".concat(t,"-title")),h=e.querySelector(".".concat(t,"-toolbar")),tt=e.querySelector(".".concat(t,"-navbar")),y=e.querySelector(".".concat(t,"-button")),it=e.querySelector(".".concat(t,"-canvas"));if(this.parent=v,this.viewer=e,this.title=nt,this.toolbar=h,this.navbar=tt,this.button=y,this.canvas=it,this.footer=e.querySelector(".".concat(t,"-footer")),this.tooltipBox=e.querySelector(".".concat(t,"-tooltip")),this.player=e.querySelector(".".concat(t,"-player")),this.list=e.querySelector(".".concat(t,"-list")),n(nt,r.title?wt(Array.isArray(r.title)?r.title[0]:r.title):w),n(tt,r.navbar?wt(r.navbar):w),rt(y,w,!r.button),r.backdrop&&(n(e,"".concat(t,"-backdrop")),r.inline||r.backdrop==="static"||ri(it,ni,"hide")),vt(r.className)&&r.className&&r.className.split(ti).forEach(function(t){n(e,t)}),r.toolbar){var ut=document.createElement("ul"),p=yt(r.toolbar),ft=at.slice(0,3),et=at.slice(7,9),ot=at.slice(9);p||n(h,wt(r.toolbar));u(p?r.toolbar:at,function(u,e){var c=p&&yt(u),h=p?ii(e):u,l=c&&!g(u.show)?u.show:u;if(l&&(r.zoomable||ft.indexOf(h)===-1)&&(r.rotatable||et.indexOf(h)===-1)&&(r.scalable||ot.indexOf(h)===-1)){var v=c&&!g(u.size)?u.size:u,a=c&&!g(u.click)?u.click:u,s=document.createElement("li");s.setAttribute("role","button");n(s,"".concat(t,"-").concat(h));o(a)||ri(s,ni,h);f(l)&&n(s,wt(l));["small","large"].indexOf(v)!==-1?n(s,"".concat(t,"-").concat(v)):h==="play"&&n(s,"".concat(t,"-large"));o(a)&&i(s,d,a);ut.appendChild(s)}});h.appendChild(ut)}else n(h,w);if(r.rotatable||(b=h.querySelectorAll('li[class*="rotate"]'),n(b,ct),u(b,function(n){h.appendChild(n)})),r.inline?(n(y,ar),l(e,{zIndex:r.zIndexInline}),window.getComputedStyle(v).position==="static"&&l(v,{position:"relative"}),v.insertBefore(e,a.nextSibling)):(n(y,lr),n(e,dt),n(e,ht),n(e,w),l(e,{zIndex:r.zIndex}),s=r.container,vt(s)&&(s=a.ownerDocument.querySelector(s)),s||(s=this.body),s.appendChild(e)),r.inline&&(this.render(),this.bind(),this.isShown=!0),this.ready=!0,o(r.ready)&&i(a,bi,r.ready,{once:!0}),c(a,bi)===!1){this.ready=!1;return}this.ready&&r.inline&&this.view(this.index)}}}],[{key:"noConflict",value:function(){return window.Viewer=au,r}},{key:"setDefaults",value:function(n){h(ei,yt(n)&&n)}}]),r}();return h(or.prototype,ou,su,hu,cu,lu),or});
/*
//# sourceMappingURL=viewer.min.js.map
*/