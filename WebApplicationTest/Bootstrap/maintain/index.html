<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.2/dist/bootstrap-table.min.css" rel="stylesheet">
    <script src="../../Scripts/jquery/jquery-3.2.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.2/dist/bootstrap-table.min.js"></script>
</head>
<body>

    <h1>任何国家都不可能垄断芯片产业链 <small>中国半导体不应盲目乐观 华为差距也不小</small></h1>
    <br />

    <table id="table"
           data-toggle="table"
           data-pagination="true"
           data-side-pagination="server"
           data-url="https://examples.wenzhixin.net.cn/examples/bootstrap_table/data"
           data-response-handler="responseHandler">
        <thead>
            <tr>
                <th data-field="state" data-checkbox="true"></th>
                <th data-field="id">ID</th>
                <th data-field="name">Item Name</th>
                <th data-field="price">Item Price</th>
            </tr>
        </thead>
    </table>

    <style type="text/css">
        small {
            color: gray;
        }
    </style>

    <script>
        var $table = $('#table')
        var selections = []

        function responseHandler(res) {
            $.each(res.rows, function (i, row) {
                row.state = $.inArray(row.id, selections) !== -1
            })
            return res
        }

        $(function () {
            $table.on('check.bs.table check-all.bs.table uncheck.bs.table uncheck-all.bs.table',
                function (e, rowsAfter, rowsBefore) {

                    console.info(e);
                    console.info(rowsAfter);
                    console.info(rowsBefore);

                    var rows = rowsAfter;

                    if (e.type === 'uncheck-all') {
                        rows = rowsBefore;
                    }

                    var ids = $.map(!$.isArray(rows) ? [rows] : rows, function (row) {
                        return row.id;
                    })

                    var func = $.inArray(e.type, ['check', 'check-all']) > -1 ? 'union' : 'difference';

                    console.info(func);

                    selections = window._[func](selections, ids);
                })
        })
    </script>
</body>
</html>