<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>PJax测试</title>
    <link href="/Scripts/themes/default/easyui.css" rel="stylesheet"/>
    <link href="/Scripts/themes/icon.css" rel="stylesheet"/>
    <link href="Index.css" rel="stylesheet"/>
    <!--<script src="../Scripts/jquery/jquery-1.7.1.js"></script>-->
    <script src="../Scripts/jquery/jquery-1.9.1.js"></script>
    <script src="/Scripts/jquery.easyui.min.js"></script>
    <script src="/Scripts/locale/easyui-lang-zh_CN.js"></script>

    <script src="js/jquery.pjax.js"></script>
    <style type="text/css">
        
        .menu_navcc {
            margin: 0 auto;
            width: 970px;
        }

        .menu_nav {
            background: url(img/nav_bg.gif) repeat-x;
            display: block;
            float: left;
            height: 48px;
            margin-top: 18px;
            width: 970px;
        }

        .menu_nav .nav_content {
            background: url(img/nav_l_bg.gif) no-repeat;
            float: left;
            padding-left: 25px;
        }

        .menu_nav .nav_content li {
            background: url(img/nav_li_right.gif) no-repeat right center;
            float: left;
            font-size: 14px;
            font-weight: bold;
            height: 48px;
            line-height: 48px;
            padding-left: 15px;
            padding-right: 13px;
            text-align: center;
            width: 88px;
        }

        .menu_nav .nav_content li a {
            color: #fff;
            display: block;
            height: 48px;
            width: 88px;
        }

        .menu_nav .nav_content li.current { line-height: 37px; }

        .menu_nav .nav_content li em {
            background: url(img/bid_new.gif) no-repeat;
            display: inline-block;
            height: 21px;
            left: 40px;
            position: absolute;
            top: -20px;
            width: 35px;
        }

        .menu_nav .nav_content li.current a, 
        .menu_nav .nav_content li.current a:hover {
            background: url(img/nav_li_current.gif) no-repeat;
            color: #fff;
            display: block;
            height: 37px;
            width: 88px;
        }

        .menu_nav .nav_content li a:hover {
            background: url(img/nav_li_hover.gif) no-repeat;
            line-height: 37px;
            text-decoration: none;
        }

        .menu_nav_right {
            background: url(img/nav_r_bg.gif) no-repeat right top;
            float: right;
            height: 23px;
            margin-left: 50px;
            padding-bottom: 12px;
            padding-right: 20px;
            padding-top: 13px;
        }

        .main { border: 1px solid #dc143c; }

        .main h2 {
            border: 1px solid #00bfff;
            height: 36px;
            line-height: 36px;
            display: block;
        }


        .main p {
            border: 1px solid #006400;
            height: 24px;
            line-height: 24px;
            margin-bottom: 25px;
            padding-top: 56px;
            display: block;  
        }
    </style>
    <script type="text/javascript">

        //pjax depends on jQuery 1.8 or higher.
        //https://www.bootcdn.cn/jquery.pjax/

        //https://www.cnblogs.com/telwanggs/p/7136716.html


        $(function() {
            $(document).pjax('.nav_content li a', 'div .main');

            $(".nav_content li a").click(function(event) {
                if ($(this).parent("li").hasClass("current")) {
                    return;
                }
                $(".nav_content li[class='current']").removeClass("current");
                $(this).parent("li").addClass("current");
            });
        });


        /**
         * 方式一 按钮父节点监听事件
         *
         * @param selector  触发点击事件的按钮
         * @param container 展示刷新内容的容器，也就是会被替换的部分
         * @param options   参数
         */
        $(document).pjax(selector, [container], options);
        // 方式二 直接对按钮监听，可以不用指定容器，使用按钮的data-pjax属性值查找容器
        $("a[data-pjax]").pjax();
        // 方式三 常规的点击事件监听方式
        $(document).on('click', 'a', $.pjax.click);
        $(document).on('click', 'a', function (event) {
            var container = $(this).closest('[data-pjax-container]');
            $.pjax.click(event, container);
        });
        // 下列是源码中介绍的其他用法，由于本人暂时没有那些需求暂时没深究，有兴趣的各位自己试试看哈
        // 表单提交
        $(document).on('submit', 'form', function (event) {
            var container = $(this).closest('[data-pjax-container]');
            $.pjax.submit(event, container);
        });
        // 加载内容到指定容器
        $.pjax({ url: this.href, container: '#main' });
        // 重新当前页面容器的内容
        $.pjax.reload('#container');




        //会有一些情况导致pjax失效，下面结合源码分析下（省略部分无关代码）
        function handleClick(event, container, options) {
            //...

            // 1. 点击事件的事件源不是a标签。使用a标签可以做到对旧版本浏览器的兼容，所以不建议使用其他标签注册事件
            if (link.tagName.toUpperCase() !== 'A')
                throw "$.fn.pjax or $.pjax.click requires an anchor element"

            // 2. 使用鼠标滚轮点击(新标签页打开)
            // 点击超链接的同时按下Shift、Ctrl、Alt和Meta（在Windows键盘中是Windows键，在苹果机中是Cmd键）
            // 作用分别代表新窗口打开、新标签打开（不切换标签）、下载、新标签打开（切换标签）
            if (event.which > 1 || event.metaKey || event.ctrlKey || event.shiftKey || event.altKey)
                return

            // 3. 跨域（网络通讯协议，域名不一致）
            if (location.protocol !== link.protocol || location.hostname !== link.hostname)
                return

            // 4. 当前页面的锚点定位
            if (link.href.indexOf('#') > -1 && stripHash(link) == stripHash(location))
                return

            // 5. 已经阻止元素发生默认的行为（url跳转）
            if (event.isDefaultPrevented())
                return

            //...

            var clickEvent = $.Event('pjax:click')
            $(link).trigger(clickEvent, [opts])

            // 6. pjax:click事件回调中已经阻止元素发生默认的行为（url跳转）
            if (!clickEvent.isDefaultPrevented()) {
                pjax(opts)
                event.preventDefault()// 阻止url跳转
                $(link).trigger('pjax:clicked', [opts])
            }
        }








    </script>

</head>
<body>
<div style="height: 10px;"></div>
<div style="clear: both"></div>
<!--nav,start-->
<div class="menu_navcc">
    <div class="menu_nav clearfix">
        <ul class="nav_content">
            <li class="current">
                <a id="home" href="Index.html" title="首页">
                    <span>首页</span></a>
            </li>
            <li>
                <a id="menu1" href="Menu1.html" title="菜单1">
                    <span>菜单1</span></a>
            </li>
            <li>
                <a id="menu2" href="Menu2.html" title="菜单2">
                    <span>菜单2</span></a>
            </li>
            <li>
                <a id="menu3" href="Menu3.html" title="菜单3">
                    <span>菜单3</span></a>
            </li>
            <li>
                <a id="menu4" href="Menu4.html" title="菜单4">
                    <span>菜单4</span></a>
            </li>
            <li>
                <a id="menu5" href="Menu5.html" title="菜单5">
                    <span>菜单5</span></a>
            </li>
        </ul>
        <div class="menu_nav_right"></div>
    </div>

    <div class="main">
        <h2>首页</h2>
        <p>Pjax测试首页</p>
    </div>
</div>
<!--<div style="clear: both"></div>-->

</body>
</html>