function validFileLenth(n){var t=n.name,i=t.getBytes()-4;return i>390?(alert("文件名称汉字限制在200字以内,英文限制在400字符以内"),!1):!0}function newGuid(){for(var i,t="",n=1;n<=32;n++)i=Math.floor(Math.random()*16).toString(16),t+=i,(n==8||n==12||n==16||n==20)&&(t+="-");return t}function GetFileList(n,t){n=n||TypeID;t=t||GroupID;var i={OPERATION:"ATTACHMENTLIST",FID:"",TID:n,GID:t,UID:UserID,RID:Math.round(Math.random()*10)};$.getJSON("/Handler/AttachmentHandler.ashx",i).done(function(n){n!=null&&n.length>0?($("#tbFileList").datagrid("loading"),$("#tbFileList").datagrid("loadData",{total:n[0].RecordCount,rows:n}),$("#tbFileList").datagrid("loaded")):($("#tbFileList").datagrid("loadData",{total:0,rows:[]}),$("#tbFileList").datagrid("loaded"))})}function DownloadFile(n,t){var i="/Handler/AttachmentHandler.ashx?OPERATION=DOWNLOAD&FID="+n+"&file="+escape(t)+"&name="+escape(name);window.location.href=i}function ViewFileOnline(n,t,i){if(t=t.replace(".",""),editFileType.indexOf(t.toLocaleLowerCase())>-1){var r=0<=navigator.userAgent.indexOf("MSIE");r?(i="/FileService/DocWatch.aspx?FID="+n,t&&(i+="&extName="+t),window.open(i,"标准体系文档")):DownloadFile(n,i)}else viewFileType.indexOf(t.toLocaleLowerCase())>-1?(i=ServiceUrl+VD+i,window.open(i,"标准体系文档")):DownloadFile(n,i)}function EditFileOnline(n,t){if(t=t.replace(".",""),editFileType.indexOf(t.toLocaleLowerCase())>-1){var i="/FileService/DocEdit.aspx?FID="+n;t&&(i+="&extName="+t);window.open(i,"文档修改")}else alert("该类型文件不可修改！")}function DelFileById(n,t){if(confirm("您确定要删除该文档吗？")){var i="/Handler/AttachmentHandler.ashx?OPERATION=DELETEFILE&FID="+n+"&GID=&TID=&PATH="+t;$.get(i+"&rnd="+Math.random()*10,function(n){n?n.IsSuccess?($.messager.alert("操作提示",n.Message,"info"),GetFileList()):alert(n.Message):alert("删除异常，请重试")})}}function BatchDownload(){var n="/Handler/AttachmentHandler.ashx?OPERATION=BATCHDOWNLOAD&FID=&TID="+TypeID+"&GID="+GroupID;$.get(n+"&rnd="+Math.random()*10,null,function(n){n?n.IsSuccess?window.open(n.Url,"附件批量下载"):$.messager.alert("操作提示",n.Message,"info"):alert("附件批量下载异常，请重试")})}function AttachmentLog(){}var fileTypeImg="doc|docx|ppt|pptx|xls|xlsx|xlt|dot|dps|dpt|et|ett|gif|htm|html|bmp|jpeg|jpg|mdb|pdf|png|pot|psd|pub|rar|rtf|txt|tif|tiff|txt|vsd|vss|vst|wps|wpt|xml|zip",viewFileType="jpg|png|pdf",editFileType="doc|docx|ppt|pptx|xls|xlsx|vso|pro|wps|et",editFileType="doc|docx|ppt|pptx|xls|xlsx|vso|pro|wps|et";String.prototype.getBytes=function(){var n=this.match(/[^\x00-\xff]/ig);return this.length+(n==null?0:n.length)};
/*
//# sourceMappingURL=Attachment.min.js.map
*/